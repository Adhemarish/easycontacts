<%#=render '../shared/navbar', user_signed_in?: user_signed_in? %>

<div class="cont-global-dash">

<div class="dash-darkblue">

  <div class="welcome pl-5 pt-3 pb-3">

  <h3>Hey <%=current_user.first_name.capitalize%></h3>
  <p>Qui avez-vous vu aujourd'hui ?</p>

    <div class="dash-searchbar d-flex justify-content-center pr-5">
      <div class="search-bar d-flex justify-content-center mb-3">

      <%#= link_to dashboard_tag_path) do%>
        <p class="ml-3  dashboard-tag">TAG</p>
        <%# end %>

          <%= form_tag dashboard_path, method: :get do %>
            <%= text_field_tag :query,
              params[:query],
              class: "placeholder-search",
              placeholder: "Je cherche..."
            %>
          <% end %>
          <i class="fas fa-search mr-2 mt-2"></i>
        </div>
      </div>
    </div>

</div>

<div class="dash-gray">

  <div class="results-container-dash d-flex justify-content-center align-items-center flex-column">
    <%if params[:query].present?  %>
    <div class="results-container">
      <% if @contacts.any?%>
        <!-- <ul class="list-group"> -->
        <div class="list-group">
        <% @contacts.each do |contact| %>
          <!-- <li class="list-group-item d-flex justify-content-center align-items-center"> -->
          <div class="list-group-item d-flex justify-content-center align-items-center">

          <div class="mt-0">
            <%= cl_image_tag contact.avatar, height: 50, width: 50, crop: :fill, class: "dash-avatar" %>
          </div>
           <%= link_to contact_path(contact) do%>
          <div class="contact-name ml-2 text-left">
            <%= contact.first_name%> <%=contact.last_name%>
          </div>
          <% end %>
          <!-- <div class=" ">
            <i class="fas fa-phone dash ml-3 mt-3"></i>
          </div> -->
          <div class="d-flex mr-3">
            <%= link_to new_contact_alert_path(contact) do%>
            <div class="d-flex contact-dash-icon mr-3">
              <i class="fas fa-bell ml-3"></i>
              <i class="fas fa-plus"></i>
            </div>
            <% end %>
            <%= link_to new_contact_note_path(contact) do%>
            <div class="d-flex contact-dash-icon ml-2">
              <i class="fas fa-sticky-note"></i>
              <i class="fas fa-plus" style="margin-left:3px;"></i>
            </div>
            <% end %>
          </div>
          <!-- </li> -->
          </div>
          </div>
          <% end %>
      </div>
        <!-- </ul> -->
      <% else %>
        <p>Aucun contact ne correspond à votre recherche.</p>
      <% end %>
      </div>
    <% end %>
  </div>

  <div class="timeline-container d-flex justify-content-center">
    <div class="timeline-dash d-flex justify-content-center flex-column">
      <%  if @upcoming_contacts_alerts.any? %>
        <% @upcoming_contacts_alerts.first(3).each do |alert| %>
        <div class="rappel-dash d-flex justify-content-between">
          <p class="rappel-date-dash pt-2 px-2"><%= I18n.l(alert.datetime, format: :short) %></p>
          <p class="rappel-contact-dash pl-2 pt-2"><%= alert.contact.first_name.capitalize %> <%= alert.contact.last_name.upcase %></p>
          <p class="rappel-title-dash pl-2 pt-2"><%= alert.title %></p>
        </div>
        <% end %>
      <% else %>
        <p>Vous n'avez pas d'alerte à venir.</p>
      <% end %>
    </div>
  </div>

  <div class="btn-dash-add-contact d-flex justify-content-center">
    <%= link_to new_contact_path do%>
    <div class="lg-btn dash d-flex align-items-center justify-content-center">
        <i class="fas fa-user-alt ml-1"></i>
        <i class="fas fa-plus mb-3"></i>
    </div>
    <% end %>

  </div>

</div>
</div>
<!-- à conserver sur cette page -->
<script type="text/javascript">
    $(function(){
        $(document).on('click','input[type=text]',function(){ this.select(); });
    });
</script>
